\hypertarget{classaacio_1_1chain_1_1fork__database}{}\section{aacio\+:\+:chain\+:\+:fork\+\_\+database Class Reference}
\label{classaacio_1_1chain_1_1fork__database}\index{aacio\+::chain\+::fork\+\_\+database@{aacio\+::chain\+::fork\+\_\+database}}


{\ttfamily \#include $<$fork\+\_\+database.\+hpp$>$}

\subsection*{Public Types}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{classaacio_1_1chain_1_1fork__database_ae2868c2b7b02d80861fbf58caeaa4373}\label{classaacio_1_1chain_1_1fork__database_ae2868c2b7b02d80861fbf58caeaa4373}} 
typedef \mbox{\hyperlink{classstd_1_1vector}{vector}}$<$ item\+\_\+ptr $>$ {\bfseries branch\+\_\+type}
\item 
\mbox{\Hypertarget{classaacio_1_1chain_1_1fork__database_a5aae893a698a70b327f5c10d5f35ee6b}\label{classaacio_1_1chain_1_1fork__database_a5aae893a698a70b327f5c10d5f35ee6b}} 
typedef multi\+\_\+index\+\_\+container$<$ item\+\_\+ptr, \mbox{\hyperlink{structaacio_1_1indexed__by}{indexed\+\_\+by}}$<$ hashed\+\_\+unique$<$ tag$<$ block\+\_\+id $>$, member$<$ \mbox{\hyperlink{structaacio_1_1chain_1_1fork__item}{fork\+\_\+item}}, \mbox{\hyperlink{classfc_1_1sha256}{block\+\_\+id\+\_\+type}}, \&fork\+\_\+item\+::id $>$, std\+::hash$<$ \mbox{\hyperlink{classfc_1_1sha256}{block\+\_\+id\+\_\+type}} $>$ $>$, hashed\+\_\+non\+\_\+unique$<$ tag$<$ by\+\_\+previous $>$, const\+\_\+mem\+\_\+fun$<$ \mbox{\hyperlink{structaacio_1_1chain_1_1fork__item}{fork\+\_\+item}}, \mbox{\hyperlink{classfc_1_1sha256}{block\+\_\+id\+\_\+type}}, \&fork\+\_\+item\+::previous\+\_\+id $>$, std\+::hash$<$ \mbox{\hyperlink{classfc_1_1sha256}{block\+\_\+id\+\_\+type}} $>$ $>$, ordered\+\_\+non\+\_\+unique$<$ tag$<$ block\+\_\+num $>$, member$<$ \mbox{\hyperlink{structaacio_1_1chain_1_1fork__item}{fork\+\_\+item}}, uint32\+\_\+t,\&fork\+\_\+item\+::num $>$ $>$ $>$ $>$ {\bfseries fork\+\_\+multi\+\_\+index\+\_\+type}
\end{DoxyCompactItemize}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{classaacio_1_1chain_1_1fork__database_a7cde14232318157659c8831a63b63022}\label{classaacio_1_1chain_1_1fork__database_a7cde14232318157659c8831a63b63022}} 
void {\bfseries reset} ()
\item 
\mbox{\Hypertarget{classaacio_1_1chain_1_1fork__database_aa43590dd9d20201f55870c0b281408b9}\label{classaacio_1_1chain_1_1fork__database_aa43590dd9d20201f55870c0b281408b9}} 
void {\bfseries start\+\_\+block} (\mbox{\hyperlink{structaacio_1_1chain_1_1signed__block}{signed\+\_\+block}} b)
\item 
\mbox{\Hypertarget{classaacio_1_1chain_1_1fork__database_af2d82f6b87b38ca0b6f639b2fd54ae08}\label{classaacio_1_1chain_1_1fork__database_af2d82f6b87b38ca0b6f639b2fd54ae08}} 
void {\bfseries remove} (\mbox{\hyperlink{classfc_1_1sha256}{block\+\_\+id\+\_\+type}} b)
\item 
\mbox{\Hypertarget{classaacio_1_1chain_1_1fork__database_a7512b29bd36e7e495ad80dce33fc5fb2}\label{classaacio_1_1chain_1_1fork__database_a7512b29bd36e7e495ad80dce33fc5fb2}} 
void {\bfseries set\+\_\+head} (\mbox{\hyperlink{classfc_1_1shared__ptr}{shared\+\_\+ptr}}$<$ \mbox{\hyperlink{structaacio_1_1chain_1_1fork__item}{fork\+\_\+item}} $>$ h)
\item 
\mbox{\Hypertarget{classaacio_1_1chain_1_1fork__database_a4e6f74761a844273b454cb907b575886}\label{classaacio_1_1chain_1_1fork__database_a4e6f74761a844273b454cb907b575886}} 
bool {\bfseries is\+\_\+known\+\_\+block} (const \mbox{\hyperlink{classfc_1_1sha256}{block\+\_\+id\+\_\+type}} \&id) const
\item 
\mbox{\Hypertarget{classaacio_1_1chain_1_1fork__database_ab58a4becabf2daed75c4a4665ed3d2ba}\label{classaacio_1_1chain_1_1fork__database_ab58a4becabf2daed75c4a4665ed3d2ba}} 
\mbox{\hyperlink{classfc_1_1shared__ptr}{shared\+\_\+ptr}}$<$ \mbox{\hyperlink{structaacio_1_1chain_1_1fork__item}{fork\+\_\+item}} $>$ {\bfseries fetch\+\_\+block} (const \mbox{\hyperlink{classfc_1_1sha256}{block\+\_\+id\+\_\+type}} \&id) const
\item 
\mbox{\Hypertarget{classaacio_1_1chain_1_1fork__database_a1d7ea264c55ff532f48906fe6b7ddf5b}\label{classaacio_1_1chain_1_1fork__database_a1d7ea264c55ff532f48906fe6b7ddf5b}} 
\mbox{\hyperlink{classstd_1_1vector}{vector}}$<$ item\+\_\+ptr $>$ {\bfseries fetch\+\_\+block\+\_\+by\+\_\+number} (uint32\+\_\+t n) const
\item 
\mbox{\hyperlink{classfc_1_1shared__ptr}{shared\+\_\+ptr}}$<$ \mbox{\hyperlink{structaacio_1_1chain_1_1fork__item}{fork\+\_\+item}} $>$ \mbox{\hyperlink{classaacio_1_1chain_1_1fork__database_ae9ce87aac5b9f14e08fccff4e6e98fdb}{push\+\_\+block}} (const \mbox{\hyperlink{structaacio_1_1chain_1_1signed__block}{signed\+\_\+block}} \&b)
\item 
\mbox{\Hypertarget{classaacio_1_1chain_1_1fork__database_a62fd37b2b67afad20e7cfb335a6b512e}\label{classaacio_1_1chain_1_1fork__database_a62fd37b2b67afad20e7cfb335a6b512e}} 
\mbox{\hyperlink{classfc_1_1shared__ptr}{shared\+\_\+ptr}}$<$ \mbox{\hyperlink{structaacio_1_1chain_1_1fork__item}{fork\+\_\+item}} $>$ {\bfseries head} () const
\item 
\mbox{\Hypertarget{classaacio_1_1chain_1_1fork__database_aa6bdd84233afbf7ad60b66372e8d9ef5}\label{classaacio_1_1chain_1_1fork__database_aa6bdd84233afbf7ad60b66372e8d9ef5}} 
void {\bfseries pop\+\_\+block} ()
\item 
\mbox{\hyperlink{structpair}{pair}}$<$ \mbox{\hyperlink{classstd_1_1vector}{branch\+\_\+type}}, \mbox{\hyperlink{classstd_1_1vector}{branch\+\_\+type}} $>$ \mbox{\hyperlink{classaacio_1_1chain_1_1fork__database_a309c5e2cb8d499551cc71356dfab46cc}{fetch\+\_\+branch\+\_\+from}} (\mbox{\hyperlink{classfc_1_1sha256}{block\+\_\+id\+\_\+type}} first, \mbox{\hyperlink{classfc_1_1sha256}{block\+\_\+id\+\_\+type}} second) const
\item 
void \mbox{\hyperlink{classaacio_1_1chain_1_1fork__database_af7877508fbed8bde99d84a582993494c}{set\+\_\+max\+\_\+size}} (uint32\+\_\+t s)
\end{DoxyCompactItemize}
\subsection*{Static Public Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{classaacio_1_1chain_1_1fork__database_aaacb7f8c80b1870832150462ce1cc448}\label{classaacio_1_1chain_1_1fork__database_aaacb7f8c80b1870832150462ce1cc448}} 
static const int \mbox{\hyperlink{classaacio_1_1chain_1_1fork__database_aaacb7f8c80b1870832150462ce1cc448}{M\+A\+X\+\_\+\+B\+L\+O\+C\+K\+\_\+\+R\+E\+O\+R\+D\+E\+R\+I\+NG}} = 1024
\begin{DoxyCompactList}\small\item\em The maximum number of blocks that may be skipped in an out-\/of-\/order push. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
As long as blocks are pushed in order the fork database will maintain a linked tree of all blocks that branch from the start\+\_\+block. The tree will have a maximum depth of 1024 blocks after which the database will start lopping off forks.

Every time a block is pushed into the fork DB the block with the highest block\+\_\+num will be returned. 

\subsection{Member Function Documentation}
\mbox{\Hypertarget{classaacio_1_1chain_1_1fork__database_a309c5e2cb8d499551cc71356dfab46cc}\label{classaacio_1_1chain_1_1fork__database_a309c5e2cb8d499551cc71356dfab46cc}} 
\index{aacio\+::chain\+::fork\+\_\+database@{aacio\+::chain\+::fork\+\_\+database}!fetch\+\_\+branch\+\_\+from@{fetch\+\_\+branch\+\_\+from}}
\index{fetch\+\_\+branch\+\_\+from@{fetch\+\_\+branch\+\_\+from}!aacio\+::chain\+::fork\+\_\+database@{aacio\+::chain\+::fork\+\_\+database}}
\subsubsection{\texorpdfstring{fetch\+\_\+branch\+\_\+from()}{fetch\_branch\_from()}}
{\footnotesize\ttfamily \mbox{\hyperlink{structpair}{pair}}$<$ \mbox{\hyperlink{classstd_1_1vector}{fork\+\_\+database\+::branch\+\_\+type}}, \mbox{\hyperlink{classstd_1_1vector}{fork\+\_\+database\+::branch\+\_\+type}} $>$ aacio\+::chain\+::fork\+\_\+database\+::fetch\+\_\+branch\+\_\+from (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classfc_1_1sha256}{block\+\_\+id\+\_\+type}}}]{first,  }\item[{\mbox{\hyperlink{classfc_1_1sha256}{block\+\_\+id\+\_\+type}}}]{second }\end{DoxyParamCaption}) const}

Given two head blocks, return two branches of the fork graph that end with a common ancestor (same prior block) Here is the caller graph for this function\+:
% FIG 0
\mbox{\Hypertarget{classaacio_1_1chain_1_1fork__database_ae9ce87aac5b9f14e08fccff4e6e98fdb}\label{classaacio_1_1chain_1_1fork__database_ae9ce87aac5b9f14e08fccff4e6e98fdb}} 
\index{aacio\+::chain\+::fork\+\_\+database@{aacio\+::chain\+::fork\+\_\+database}!push\+\_\+block@{push\+\_\+block}}
\index{push\+\_\+block@{push\+\_\+block}!aacio\+::chain\+::fork\+\_\+database@{aacio\+::chain\+::fork\+\_\+database}}
\subsubsection{\texorpdfstring{push\+\_\+block()}{push\_block()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classfc_1_1shared__ptr}{shared\+\_\+ptr}}$<$ \mbox{\hyperlink{structaacio_1_1chain_1_1fork__item}{fork\+\_\+item}} $>$ aacio\+::chain\+::fork\+\_\+database\+::push\+\_\+block (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{structaacio_1_1chain_1_1signed__block}{signed\+\_\+block}} \&}]{b }\end{DoxyParamCaption})}

\begin{DoxyReturn}{Returns}
the new head block ( the longest fork )
\end{DoxyReturn}
Pushes the block into the fork database and caches it if it doesn\textquotesingle{}t link Here is the caller graph for this function\+:
% FIG 1
\mbox{\Hypertarget{classaacio_1_1chain_1_1fork__database_af7877508fbed8bde99d84a582993494c}\label{classaacio_1_1chain_1_1fork__database_af7877508fbed8bde99d84a582993494c}} 
\index{aacio\+::chain\+::fork\+\_\+database@{aacio\+::chain\+::fork\+\_\+database}!set\+\_\+max\+\_\+size@{set\+\_\+max\+\_\+size}}
\index{set\+\_\+max\+\_\+size@{set\+\_\+max\+\_\+size}!aacio\+::chain\+::fork\+\_\+database@{aacio\+::chain\+::fork\+\_\+database}}
\subsubsection{\texorpdfstring{set\+\_\+max\+\_\+size()}{set\_max\_size()}}
{\footnotesize\ttfamily void aacio\+::chain\+::fork\+\_\+database\+::set\+\_\+max\+\_\+size (\begin{DoxyParamCaption}\item[{uint32\+\_\+t}]{s }\end{DoxyParamCaption})}

index

unlinked\+\_\+index Here is the call graph for this function\+:
% FIG 2


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
libraries/chain/include/aacio/chain/\mbox{\hyperlink{fork__database_8hpp}{fork\+\_\+database.\+hpp}}\item 
libraries/chain/\mbox{\hyperlink{fork__database_8cpp}{fork\+\_\+database.\+cpp}}\end{DoxyCompactItemize}
