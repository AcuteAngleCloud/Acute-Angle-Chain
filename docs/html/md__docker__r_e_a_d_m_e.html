<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Acute-Angle-Chain: Run in docker</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="aac-logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Acute-Angle-Chain
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Run in docker </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Simple and fast setup of AAC.IO on Docker is also available.</p>
<h2>Install Dependencies</h2>
<ul>
<li><a href="https://docs.docker.com">Docker</a> Docker 17.05 or higher is required</li>
<li><a href="https://docs.docker.com/compose/">docker-compose</a> version &gt;= 1.10.0</li>
</ul>
<h2>Docker Requirement</h2>
<ul>
<li>At least 8GB RAM (Docker -&gt; Preferences -&gt; Advanced -&gt; Memory -&gt; 8GB or above)</li>
</ul>
<h2>Build aac image</h2>
<div class="fragment"><div class="line">git clone https://github.com/AACIO/aac.git --recursive</div><div class="line">cd Acute-Angle-Chain/Docker</div><div class="line">docker build . -t aacio/aac</div></div><!-- fragment --><h2>Start nodaac docker container only</h2>
<div class="fragment"><div class="line">docker run --name nodaac -p 8888:8888 -p 9876:9876 -t aacio/aac nodaacd.sh arg1 arg2</div></div><!-- fragment --><p>By default, all data is persisted in a docker volume. It can be deleted if the data is outdated or corrupted: </p><div class="fragment"><div class="line">$ docker inspect --format &#39;{{ range .Mounts }}{{ .Name }} {{ end }}&#39; nodaac</div><div class="line">fdc265730a4f697346fa8b078c176e315b959e79365fc9cbd11f090ea0cb5cbc</div><div class="line">$ docker volume rm fdc265730a4f697346fa8b078c176e315b959e79365fc9cbd11f090ea0cb5cbc</div></div><!-- fragment --><p>Alternately, you can directly mount host directory into the container </p><div class="fragment"><div class="line">docker run --name nodaac -v /path-to-data-dir:/opt/aacio/bin/data-dir -p 8888:8888 -p 9876:9876 -t aacio/aac nodaacd.sh arg1 arg2</div></div><!-- fragment --><h2>Get chain info</h2>
<div class="fragment"><div class="line">curl http://127.0.0.1:8888/v1/chain/get_info</div></div><!-- fragment --><h2>Start both nodaac and kaacd containers</h2>
<div class="fragment"><div class="line">docker volume create --name=nodaac-data-volume</div><div class="line">docker volume create --name=kaacd-data-volume</div><div class="line">docker-compose up -d</div></div><!-- fragment --><p>After <code>docker-compose up -d</code>, two services named <code>nodaacd</code> and <code>kaacd</code> will be started. nodaac service would expose ports 8888 and 9876 to the host. kaacd service does not expose any port to the host, it is only accessible to claac when runing claac is running inside the kaacd container as described in "Execute claac commands" section.</p>
<h3>Execute claac commands</h3>
<p>You can run the <code>claac</code> commands via a bash alias.</p>
<div class="fragment"><div class="line">alias claac=&#39;docker-compose exec kaacd /opt/aacio/bin/claac -H nodaacd&#39;</div><div class="line">claac get info</div><div class="line">claac get account inita</div></div><!-- fragment --><p>Upload sample exchange contract</p>
<div class="fragment"><div class="line">claac set contract exchange contracts/exchange/exchange.wast contracts/exchange/exchange.abi</div></div><!-- fragment --><p>If you don't need kaacd afterwards, you can stop the kaacd service using</p>
<div class="fragment"><div class="line">docker-compose stop kaacd</div></div><!-- fragment --> <h3>Change default configuration</h3>
<p>You can use docker compose override file to change the default configurations. For example, create an alternate config file <code>config2.ini</code> and a <code>docker-compose.override.yml</code> with the following content.</p>
<div class="fragment"><div class="line">version: &quot;2&quot;</div><div class="line"></div><div class="line">services:</div><div class="line">  nodaac:</div><div class="line">    volumes:</div><div class="line">      - nodaac-data-volume:/opt/aacio/bin/data-dir</div><div class="line">      - ./config2.ini:/opt/aacio/bin/data-dir/config.ini</div></div><!-- fragment --><p>Then restart your docker containers as follows:</p>
<div class="fragment"><div class="line">docker-compose down</div><div class="line">docker-compose up</div></div><!-- fragment --><h3>Clear data-dir</h3>
<p>The data volume created by docker-compose can be deleted as follows:</p>
<div class="fragment"><div class="line">docker volume rm nodaac-data-volume</div><div class="line">docker volume rm kaacd-data-volume</div></div><!-- fragment --> </div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
