<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Acute-Angle-Chain: AACIO Developer Tutorial</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="aac-logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Acute-Angle-Chain
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">AACIO Developer Tutorial </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The purpose of this tutorial is to demonstrate how to setup a local blockchain that can be used to experiment with smart contracts. The first part of this tutorial will focus on:</p>
<ol type="1">
<li>Starting a <a class="el" href="struct_node.html">Node</a></li>
<li>Creating a Wallet</li>
<li>Creating Accounts</li>
<li>Deploying Contracts</li>
<li>Interacting with Contracts</li>
</ol>
<p>The second part of this tutorial will walk you through creating and deploying your own contracts.</p>
<p>This tutorial assumes that you have installed AACIO and that <code>nodaac</code> and <code>claac</code> are in your path.</p>
<h2>Starting a Private Blockchain</h2>
<p>You can start your own single-node blockchain with this single command:</p>
<div class="fragment"><div class="line">$ nodaac -e -p aacio --plugin aacio::wallet_api_plugin --plugin aacio::chain_api_plugin --plugin aacio::account_history_api_plugin </div><div class="line">...</div><div class="line">aacio generated block 046b9984... #101527 @ 2018-04-01T14:24:58.000 with 0 trxs</div><div class="line">aacio generated block 5e527ee2... #101528 @ 2018-04-01T14:24:58.500 with 0 trxs</div></div><!-- fragment --><p>This command sets many flags and loads some optional plugins which we will need for the rest of this tutorial. Assuming everything worked properly, you should see a block generation message every 0.5 seconds. <br />
 </p><div class="fragment"><div class="line">aacio generated block 046b9984... #101527 @ 2018-04-01T14:24:58.000 with 0 trxs</div></div><!-- fragment --><p>This means your local blockchain is live, producing blocks, and ready to be used.</p>
<p>For more information about the arguments to <code>nodaac</code> you can use:</p>
<div class="fragment"><div class="line">nodaac --help</div></div><!-- fragment --><h2>Creating a Wallet</h2>
<p><a class="el" href="struct_a.html">A</a> wallet is a repository of private keys necessary to authorize actions on the blockchain. These keys are stored on disk encrypted using a password generated for you. This password should be stored in a secure password manager.</p>
<div class="fragment"><div class="line">$ claac wallet create</div><div class="line">Creating wallet: default</div><div class="line">Save password to use in the future to unlock this wallet.</div><div class="line">Without password imported keys will not be retrievable.</div><div class="line">&quot;PW5JuBXoXJ8JHiCTXfXcYuJabjF9f9UNNqHJjqDVY7igVffe3pXub&quot;</div></div><!-- fragment --><p>For the purpose of this simple development environment, your wallet is being managed by your local <code>nodaac</code> via the <code><a class="el" href="classaacio_1_1wallet__api__plugin.html">aacio::wallet_api_plugin</a></code> we enabled when we started <code>nodaac</code>. Any time you restart <code>nodaac</code> you will have to unlock your wallet before you can use the keys within.</p>
<div class="fragment"><div class="line">$ claac wallet unlock --password PW5JuBXoXJ8JHiCTXfXcYuJabjF9f9UNNqHJjqDVY7igVffe3pXub</div><div class="line">Unlocked: default</div></div><!-- fragment --><p>It is generally not secure to use your password directly on the commandline where it gets logged to your bash history, so you can also unlock in interactive mode:</p>
<div class="fragment"><div class="line">$ claac wallet unlock</div><div class="line">password:</div></div><!-- fragment --><p>For security purposes it is generally best to leave your wallet locked when you are not using it. To lock your wallet without shutting down <code>nodaac</code> you can do:</p>
<div class="fragment"><div class="line">$ claac wallet lock</div><div class="line">Locked: default</div></div><!-- fragment --><p>You will need your wallet unlocked for the rest of this tutorial.</p>
<p>All new blockchains start out with a master key for the sole initial account, <code>aacio</code>. To interact with the blockchain you will need to import this initial account's private key into your wallet.</p>
<p>Import the master key for the <code>aacio</code> account into your wallet. The master key can be found in the <code>config.ini</code> file in the config folder for <code>nodaac</code>. In this example, the default config folder is used. On Linux systems, this will be in <code>~/.local/share/aacio/nodAcute-Angle-Chain/config</code> and on MacOS, this will be in <code>~/Library/Application Support/aacio/nodAcute-Angle-Chain/config</code>.</p>
<div class="fragment"><div class="line">$ claac wallet import 5Jgm1N6jp3iNbFM45kPtj66xmbqT9fSuVJgPWfnCSPgQanvW6mJ</div><div class="line">imported private key for: AAC84snobCGtpQvTTfVaxvMuxGDd4p2LhtQhbWX1yWAU5yt4tiB55</div></div><!-- fragment --><h2>Load the Bios Contract</h2>
<p>Now that we have a wallet with the key for the <code>aacio</code> account loaded, we can set a default system contract. For the purposes of development, the default <code><a class="el" href="classaacio_1_1bios.html">aacio.bios</a></code> contract can be used. This contract enables you to have direct control over the resource allocation of other accounts and to access other privileged API calls. In a public blockchain, this contract will manage the staking and unstaking of tokens to reserve bandwidth for CPU and network activity, and memory for contracts.</p>
<p>The <code><a class="el" href="classaacio_1_1bios.html">aacio.bios</a></code> contract can be found in the <code>contracts/aacio.bios</code> folder of your AACIO source code. The command sequence below assumes it is being executed from the root of the AACIO source, but you can execute it from anywhere by specifying the full path to <code>${AACIO_SOURCE}/build/contracts/aacio.bios</code>.</p>
<div class="fragment"><div class="line">$ claac set contract aacio build/contracts/aacio.bios -p aacio</div><div class="line">Reading WAST...</div><div class="line">Assembling WASM...</div><div class="line">Publishing contract...</div><div class="line">executed transaction: 414cf0dc7740d22474992779b2416b0eabdbc91522c16521307dd682051af083  4068 bytes  10000 cycles</div><div class="line">#         aacio &lt;= aacio::setcode               {&quot;account&quot;:&quot;aacio&quot;,&quot;vmtype&quot;:0,&quot;vmversion&quot;:0,&quot;code&quot;:&quot;0061736d0100000001ab011960037f7e7f0060057f7e7e7e...</div><div class="line">#         aacio &lt;= aacio::setabi                {&quot;account&quot;:&quot;aacio&quot;,&quot;abi&quot;:{&quot;types&quot;:[],&quot;structs&quot;:[{&quot;name&quot;:&quot;set_account_limits&quot;,&quot;base&quot;:&quot;&quot;,&quot;fields&quot;:[{&quot;n...</div></div><!-- fragment --><p>The result of this command sequence is that <code>claac</code> generated a transaction with two actions, <code>aacio::setcode</code> and <code>aacio::setabi</code>. <br />
 The code defines how the contract runs and the abi describes how to convert between binary and json representations of the arguments. While an abi is technically optional, all of the AACIO tooling depends upon it for ease of use. <br />
 Any time you execute a transaction you will see output like: </p><div class="fragment"><div class="line">executed transaction: 414cf0dc7740d22474992779b2416b0eabdbc91522c16521307dd682051af083  4068 bytes  10000 cycles</div><div class="line">#         aacio &lt;= aacio::setcode               {&quot;account&quot;:&quot;aacio&quot;,&quot;vmtype&quot;:0,&quot;vmversion&quot;:0,&quot;code&quot;:&quot;0061736d0100000001ab011960037f7e7f0060057f7e7e7e...</div><div class="line">#         aacio &lt;= aacio::setabi                {&quot;account&quot;:&quot;aacio&quot;,&quot;abi&quot;:{&quot;types&quot;:[],&quot;structs&quot;:[{&quot;name&quot;:&quot;set_account_limits&quot;,&quot;base&quot;:&quot;&quot;,&quot;fields&quot;:[{&quot;n...</div></div><!-- fragment --><p>This can be read as: The action <code>setcode</code> as defined by <code>aacio</code> was executed by <code>aacio</code> contract with <code>{args...}</code>.</p>
<div class="fragment"><div class="line">#         ${executor} &lt;= ${contract}:${action} ${args...}</div><div class="line">&gt; console output from this execution, if any</div></div><!-- fragment --><p>As we will see in a bit, actions can be processed by more than one contract.</p>
<p>The last argument to this call was <code>-p aacio</code>. This tells <code>claac</code> to sign this action with the active authority of the <code>aacio</code> account, i.e., to sign the action using the private key for the <code>aacio</code> account that we imported earlier.</p>
<h2>Create an Account</h2>
<p>Now that we have setup the basic system contract, we can start to create our own accounts. We will create two accounts, <code>user</code> and <code>tester</code>, and we will need to associate a key with each account. In this example, the same key will be used for both accounts.</p>
<p>To do this we first generate a key for the accounts.</p>
<div class="fragment"><div class="line">$ claac create key</div><div class="line">Private key: 5Jmsawgsp1tQ3GD6JyGCwy1dcvqKZgX6ugMVMdjirx85iv5VyPR</div><div class="line">Public key: AAC7ijWCBmoXBi3CgtK7DJxentZZeTkeUnaSDvyro9dq7Sd1C3dC4</div></div><!-- fragment --><p>Then we import this key into our wallet: </p><div class="fragment"><div class="line">$ claac wallet import 5Jmsawgsp1tQ3GD6JyGCwy1dcvqKZgX6ugMVMdjirx85iv5VyPR</div><div class="line">imported private key for: AAC7ijWCBmoXBi3CgtK7DJxentZZeTkeUnaSDvyro9dq7Sd1C3dC4</div></div><!-- fragment --><p> <b>NOTE:</b> Be sure to use the actual key value generated by the <code>claac</code> command and not the one shown in the example above!</p>
<p>Keys are not automatically added to a wallet, so skipping this step could result in losing control of your account.</p>
<h2>Create <a class="el" href="struct_two.html">Two</a> User Accounts</h2>
<p>Next we will create two accounts, <code>user</code> and <code>tester</code>, using the key we created and imported above.</p>
<div class="fragment"><div class="line">$ claac create account aacio user AAC7ijWCBmoXBi3CgtK7DJxentZZeTkeUnaSDvyro9dq7Sd1C3dC4 AAC7ijWCBmoXBi3CgtK7DJxentZZeTkeUnaSDvyro9dq7Sd1C3dC4</div><div class="line">executed transaction: 8aedb926cc1ca31642ada8daf4350833c95cbe98b869230f44da76d70f6d6242  364 bytes  1000 cycles</div><div class="line">#         aacio &lt;= aacio::newaccount            {&quot;creator&quot;:&quot;aacio&quot;,&quot;name&quot;:&quot;user&quot;,&quot;owner&quot;:{&quot;threshold&quot;:1,&quot;keys&quot;:[{&quot;key&quot;:&quot;AAC7ijWCBmoXBi3CgtK7DJxentZZ...</div><div class="line"></div><div class="line">$ claac create account aacio tester AAC7ijWCBmoXBi3CgtK7DJxentZZeTkeUnaSDvyro9dq7Sd1C3dC4 AAC7ijWCBmoXBi3CgtK7DJxentZZeTkeUnaSDvyro9dq7Sd1C3dC4</div><div class="line">executed transaction: 414cf0dc7740d22474992779b2416b0eabdbc91522c16521307dd682051af083 366 bytes  1000 cycles</div><div class="line">#         aacio &lt;= aacio::newaccount            {&quot;creator&quot;:&quot;aacio&quot;,&quot;name&quot;:&quot;tester&quot;,&quot;owner&quot;:{&quot;threshold&quot;:1,&quot;keys&quot;:[{&quot;key&quot;:&quot;AAC7ijWCBmoXBi3CgtK7DJxentZZ...</div></div><!-- fragment --><p> <b>NOTE:</b> The <code>create account</code> subcommand requires two keys, one for the OwnerKey (which in a production environment should be kept highly secure) and one for the ActiveKey. In this tutorial example, the same key is used for both.</p>
<p>Because we are using the <code><a class="el" href="classaacio_1_1account__history__api__plugin.html">aacio::account_history_api_plugin</a></code> we can query all accounts that are controlled by our key:</p>
<div class="fragment"><div class="line">$ claac get accounts AAC7ijWCBmoXBi3CgtK7DJxentZZeTkeUnaSDvyro9dq7Sd1C3dC4</div><div class="line">{</div><div class="line">  &quot;account_names&quot;: [</div><div class="line">    &quot;tester&quot;,</div><div class="line">    &quot;user&quot;</div><div class="line">  ]</div><div class="line">}</div></div><!-- fragment --><h2>Create Token Contract</h2>
<p>At this stage the blockchain doesn't do much, so let's deploy the <code><a class="el" href="classaacio_1_1token.html">aacio.token</a></code> contract. This contract enables the creation of many different tokens all running on the same contract but potentially managed by different users.</p>
<p>Before we can deploy the token contract we must create an account to deploy it to.</p>
<div class="fragment"><div class="line">$ claac create account aacio aacio.token  AAC7ijWCBmoXBi3CgtK7DJxentZZeTkeUnaSDvyro9dq7Sd1C3dC4 AAC7ijWCBmoXBi3CgtK7DJxentZZeTkeUnaSDvyro9dq7Sd1C3dC4</div><div class="line">...</div></div><!-- fragment --><p>Then we can deploy the contract which can be found in <code>${AACIO_SOURCE}/build/contracts/aacio.token</code></p>
<div class="fragment"><div class="line">$ claac set contract aacio.token build/contracts/aacio.token -p aacio.token</div><div class="line">Reading WAST...</div><div class="line">Assembling WASM...</div><div class="line">Publishing contract...</div><div class="line">executed transaction: 528bdbce1181dc5fd72a24e4181e6587dace8ab43b2d7ac9b22b2017992a07ad  8708 bytes  10000 cycles</div><div class="line">#         aacio &lt;= aacio::setcode               {&quot;account&quot;:&quot;aacio.token&quot;,&quot;vmtype&quot;:0,&quot;vmversion&quot;:0,&quot;code&quot;:&quot;0061736d0100000001ce011d60067f7e7f7f7f7f00...</div><div class="line">#         aacio &lt;= aacio::setabi                {&quot;account&quot;:&quot;aacio.token&quot;,&quot;abi&quot;:{&quot;types&quot;:[],&quot;structs&quot;:[{&quot;name&quot;:&quot;transfer&quot;,&quot;base&quot;:&quot;&quot;,&quot;fields&quot;:[{&quot;name&quot;...</div></div><!-- fragment --><h3>Create the AAC Token</h3>
<p>You can view the interface to <code><a class="el" href="classaacio_1_1token.html">aacio.token</a></code> as defined by <code>contracts/aacio.token/aacio.<a class="el" href="token_8hpp.html" title="Defines types and ABI for standard token messages and database tables. ">token.hpp</a></code>: </p><div class="fragment"><div class="line">void create( account_name issuer,</div><div class="line">             asset        maximum_supply,</div><div class="line">             uint8_t      can_freeze,</div><div class="line">             uint8_t      can_recall,</div><div class="line">             uint8_t      can_whitelist );</div><div class="line"></div><div class="line"></div><div class="line">void issue( account_name to, asset quantity, string memo );</div><div class="line"></div><div class="line">void transfer( account_name from,</div><div class="line">               account_name to,</div><div class="line">               asset        quantity,</div><div class="line">               string       memo );</div></div><!-- fragment --><p>To create a new token we must call the <code>create(...)</code> action with the proper arguments. This command will use the symbol of the maximum supply to uniquely identify this token from other tokens. The issuer will be the one with authority to call issue and or perform other actions such as freezing, recalling, and whitelisting of owners.</p>
<p>The concise way to call this method, using positional arguments: </p><div class="fragment"><div class="line">$ claac push action aacio.token create &#39;[ &quot;aacio&quot;, &quot;1000000000.0000 AAC&quot;, 0, 0, 0]&#39; -p aacio.token</div><div class="line">executed transaction: 0e49a421f6e75f4c5e09dd738a02d3f51bd18a0cf31894f68d335cd70d9c0e12  260 bytes  1000 cycles</div><div class="line">#   aacio.token &lt;= aacio.token::create          {&quot;issuer&quot;:&quot;aacio&quot;,&quot;maximum_supply&quot;:&quot;1000000000.0000 AAC&quot;,&quot;can_freeze&quot;:0,&quot;can_recall&quot;:0,&quot;can_whitelis...</div></div><!-- fragment --><p>Alternatively, a more verbose way to call this method, using named arguments:</p>
<div class="fragment"><div class="line">$ claac push action aacio.token create &#39;{&quot;issuer&quot;:&quot;aacio&quot;, &quot;maximum_supply&quot;:&quot;1000000000.0000 AAC&quot;, &quot;can_freeze&quot;:0, &quot;can_recall&quot;:0, &quot;can_whitelist&quot;:0}&#39; -p aacio.token</div><div class="line">executed transaction: 0e49a421f6e75f4c5e09dd738a02d3f51bd18a0cf31894f68d335cd70d9c0e12  260 bytes  1000 cycles</div><div class="line">#   aacio.token &lt;= aacio.token::create          {&quot;issuer&quot;:&quot;aacio&quot;,&quot;maximum_supply&quot;:&quot;1000000000.0000 AAC&quot;,&quot;can_freeze&quot;:0,&quot;can_recall&quot;:0,&quot;can_whitelis...</div></div><!-- fragment --><p>This command created a new token <code>AAC</code> with a pecision of 4 decimials and a maximum supply of 1000000000.0000 AAC.</p>
<p>In order to create this token we required the permission of the <code><a class="el" href="classaacio_1_1token.html">aacio.token</a></code> contract because it "owns" the symbol namespace (e.g. "AAC"). Future versions of this contract may allow other parties to buy symbol names automatically. For this reason we must pass <code>-p <a class="el" href="classaacio_1_1token.html">aacio.token</a></code> to authorize this call.</p>
<h3>Issue Tokens to Account "User"</h3>
<p>Now that we have created the token, the issuer can issue new tokens to the account <code>user</code> we created earlier.</p>
<p>We will use the positional calling convention (vs named args).</p>
<div class="fragment"><div class="line">$ claac push action aacio.token issue &#39;[ &quot;user&quot;, &quot;100.0000 AAC&quot;, &quot;memo&quot; ]&#39; -p aacio</div><div class="line">executed transaction: 822a607a9196112831ecc2dc14ffb1722634f1749f3ac18b73ffacd41160b019  268 bytes  1000 cycles</div><div class="line">#   aacio.token &lt;= aacio.token::issue           {&quot;to&quot;:&quot;user&quot;,&quot;quantity&quot;:&quot;100.0000 AAC&quot;,&quot;memo&quot;:&quot;memo&quot;}</div><div class="line">&gt;&gt; issue</div><div class="line">#   aacio.token &lt;= aacio.token::transfer        {&quot;from&quot;:&quot;aacio&quot;,&quot;to&quot;:&quot;user&quot;,&quot;quantity&quot;:&quot;100.0000 AAC&quot;,&quot;memo&quot;:&quot;memo&quot;}</div><div class="line">&gt;&gt; transfer</div><div class="line">#         aacio &lt;= aacio.token::transfer        {&quot;from&quot;:&quot;aacio&quot;,&quot;to&quot;:&quot;user&quot;,&quot;quantity&quot;:&quot;100.0000 AAC&quot;,&quot;memo&quot;:&quot;memo&quot;}</div><div class="line">#          user &lt;= aacio.token::transfer        {&quot;from&quot;:&quot;aacio&quot;,&quot;to&quot;:&quot;user&quot;,&quot;quantity&quot;:&quot;100.0000 AAC&quot;,&quot;memo&quot;:&quot;memo&quot;}</div></div><!-- fragment --><p>This time the output contains several different actions: one issue and three transfers. While the only action we signed was <code>issue</code>, the <code>issue</code> action performed an "inline transfer" and the "inline transfer" notified the sender and receiver accounts. The output indicates all of the action handlers that were called, the order they were called in, and whether or not any output was generated by the action.</p>
<p>Technically, the <code><a class="el" href="classaacio_1_1token.html">aacio.token</a></code> contract could have skipped the <code>inline transfer</code> and opted to just modify the balances directly. However, in this case, the <code><a class="el" href="classaacio_1_1token.html">aacio.token</a></code> contract is following our token convention that requires that all account balances be derivable by the sum of the transfer actions that reference them. It also requires that the sender and receiver of funds be notified so they can automate handling deposits and withdrawals.</p>
<p>If you want to see the actual transaction that was broadcast, you can use the <code>-d -j</code> options to indicate "don't broadcast" and "return transaction as json".</p>
<div class="fragment"><div class="line">$ claac push action aacio.token issue &#39;[&quot;user&quot;, &quot;100.0000 AAC&quot;, &quot;memo&quot;]&#39; -p aacio -d -j</div><div class="line">{</div><div class="line">  &quot;expiration&quot;: &quot;2018-04-01T15:20:44&quot;,</div><div class="line">  &quot;region&quot;: 0,</div><div class="line">  &quot;ref_block_num&quot;: 42580,</div><div class="line">  &quot;ref_block_prefix&quot;: 3987474256,</div><div class="line">  &quot;net_usage_words&quot;: 21,</div><div class="line">  &quot;kcpu_usage&quot;: 1000,</div><div class="line">  &quot;delay_sec&quot;: 0,</div><div class="line">  &quot;context_free_actions&quot;: [],</div><div class="line">  &quot;actions&quot;: [{</div><div class="line">      &quot;account&quot;: &quot;aacio.token&quot;,</div><div class="line">      &quot;name&quot;: &quot;issue&quot;,</div><div class="line">      &quot;authorization&quot;: [{</div><div class="line">          &quot;actor&quot;: &quot;aacio&quot;,</div><div class="line">          &quot;permission&quot;: &quot;active&quot;</div><div class="line">        }</div><div class="line">      ],</div><div class="line">      &quot;data&quot;: &quot;00000000007015d640420f000000000004454f5300000000046d656d6f&quot;</div><div class="line">    }</div><div class="line">  ],</div><div class="line">  &quot;signatures&quot;: [</div><div class="line">    &quot;AACJzPywCKsgBitRh9kxFNeMJc8BeD6QZLagtXzmdS2ib5gKTeELiVxXvcnrdRUiY3ExP9saVkdkzvUNyRZSXj2CLJnj7U42H&quot;</div><div class="line">  ],</div><div class="line">  &quot;context_free_data&quot;: []</div><div class="line">}</div></div><!-- fragment --><h3>Transfer Tokens to Account "Tester"</h3>
<p>Now that account <code>user</code> has tokens, we will transfer some to account <code>tester</code>. We indicate that <code>user</code> authorized this action using the permission argument <code>-p user</code>.</p>
<div class="fragment"><div class="line">$ claac push action aacio.token transfer &#39;[ &quot;user&quot;, &quot;tester&quot;, &quot;25.0000 AAC&quot;, &quot;m&quot; ]&#39; -p user</div><div class="line">executed transaction: 06d0a99652c11637230d08a207520bf38066b8817ef7cafaab2f0344aafd7018  268 bytes  1000 cycles</div><div class="line">#   aacio.token &lt;= aacio.token::transfer        {&quot;from&quot;:&quot;user&quot;,&quot;to&quot;:&quot;tester&quot;,&quot;quantity&quot;:&quot;25.0000 AAC&quot;,&quot;memo&quot;:&quot;m&quot;}</div><div class="line">&gt;&gt; transfer</div><div class="line">#          user &lt;= aacio.token::transfer        {&quot;from&quot;:&quot;user&quot;,&quot;to&quot;:&quot;tester&quot;,&quot;quantity&quot;:&quot;25.0000 AAC&quot;,&quot;memo&quot;:&quot;m&quot;}</div><div class="line">#        tester &lt;= aacio.token::transfer        {&quot;from&quot;:&quot;user&quot;,&quot;to&quot;:&quot;tester&quot;,&quot;quantity&quot;:&quot;25.0000 AAC&quot;,&quot;memo&quot;:&quot;m&quot;}</div></div><!-- fragment --><h2>Hello World Contract</h2>
<p>We will now create our first "hello world" contract. Create a new folder called "hello", cd into the folder, then create a file "hello.cpp" with the following contents:</p>
<p>#### hello/hello.cpp </p><div class="fragment"><div class="line">#include &lt;aaciolib/aacio.hpp&gt;</div><div class="line">#include &lt;aaciolib/print.hpp&gt;</div><div class="line">using namespace aacio;</div><div class="line"></div><div class="line">class hello : public aacio::contract {</div><div class="line">  public:</div><div class="line">      using contract::contract;</div><div class="line"></div><div class="line">      /// @abi action </div><div class="line">      void hi( account_name user ) {</div><div class="line">         print( &quot;Hello, &quot;, name{user} );</div><div class="line">      }</div><div class="line">};</div><div class="line"></div><div class="line">AACIO_ABI( hello, (hi) )</div></div><!-- fragment --><p>You can compile your code to web assmebly (.wast) as follows: </p><div class="fragment"><div class="line">$ aaciocpp -o hello.wast hello.cpp</div></div><!-- fragment --><p> <b>NOTE:</b> The compiler might generate warnings. These can be safely ignored.</p>
<p>Now generate the abi:</p>
<div class="fragment"><div class="line">$ aaciocpp -g hello.abi hello.cpp</div><div class="line">Generated hello.abi</div></div><!-- fragment --><p>Create an account and upload the contract:</p>
<div class="fragment"><div class="line">$ claac create account aacio hello.code AAC7ijWCBmoXBi3CgtK7DJxentZZeTkeUnaSDvyro9dq7Sd1C3dC4 AAC7ijWCBmoXBi3CgtK7DJxentZZeTkeUnaSDvyro9dq7Sd1C3dC4</div><div class="line">...</div><div class="line">$ claac set contract hello.code ../hello -p hello.code</div><div class="line">...</div></div><!-- fragment --><p>Now we can run the contract:</p>
<div class="fragment"><div class="line">$ claac push action hello.code hi &#39;[&quot;user&quot;]&#39; -p user</div><div class="line">executed transaction: 4c10c1426c16b1656e802f3302677594731b380b18a44851d38e8b5275072857  244 bytes  1000 cycles</div><div class="line">#    hello.code &lt;= hello.code::hi               {&quot;user&quot;:&quot;user&quot;}</div><div class="line">&gt;&gt; Hello, user</div></div><!-- fragment --><p>At this time the contract allows anyone to authorize it, we could also say:</p>
<div class="fragment"><div class="line">$ claac push action hello.code hi &#39;[&quot;user&quot;]&#39; -p tester</div><div class="line">executed transaction: 28d92256c8ffd8b0255be324e4596b7c745f50f85722d0c4400471bc184b9a16  244 bytes  1000 cycles</div><div class="line">#    hello.code &lt;= hello.code::hi               {&quot;user&quot;:&quot;user&quot;}</div><div class="line">&gt;&gt; Hello, user</div></div><!-- fragment --><p>In this case tester is the one who authorized it and user is just an argument. If we want our contact to authenticate the user we are saying "hi" to, then we need to modify the contract to require authentication.</p>
<p>Modify the hi() function in hello.cpp as follows: </p><div class="fragment"><div class="line">void hi( account_name user ) {</div><div class="line">   require_auth( user );</div><div class="line">   print( &quot;Hello, &quot;, name{user} );</div><div class="line">}</div></div><!-- fragment --><p> Repeat the steps to compile the wast file and generate the abi, then set the contract again to deploy the update.</p>
<p>Now if we attempt to mismatch the user and the authority, the contract will throw an error: </p><div class="fragment"><div class="line">$ claac push action hello.code hi &#39;[&quot;tester&quot;]&#39; -p user</div><div class="line">Error 3030001: missing required authority</div><div class="line">Ensure that you have the related authority inside your transaction!;</div><div class="line">If you are currently using &#39;claac push action&#39; command, try to add the relevant authority using -p option.</div><div class="line">Error Details:</div><div class="line">missing authority of tester</div></div><!-- fragment --><p>We can fix this by giving the permission of tester:</p>
<div class="fragment"><div class="line">$ claac push action hello.code hi &#39;[&quot;tester&quot;]&#39; -p tester</div><div class="line">executed transaction: 235bd766c2097f4a698cfb948eb2e709532df8d18458b92c9c6aae74ed8e4518  244 bytes  1000 cycles</div><div class="line">#    hello.code &lt;= hello.code::hi               {&quot;user&quot;:&quot;tester&quot;}</div><div class="line">&gt;&gt; Hello, tester</div></div><!-- fragment --><h2>Deploy Exchange Contract</h2>
<p>Similar to the examples shown above, we can deploy the exchange contract. It is assumed this is being run from the root of the AACIO source.</p>
<div class="fragment"><div class="line">$ claac create account aacio exchange  AAC7ijWCBmoXBi3CgtK7DJxentZZeTkeUnaSDvyro9dq7Sd1C3dC4 AAC7ijWCBmoXBi3CgtK7DJxentZZeTkeUnaSDvyro9dq7Sd1C3dC4</div><div class="line">executed transaction: 4d38de16631a2dc698f1d433f7eb30982d855219e7c7314a888efbbba04e571c  364 bytes  1000 cycles</div><div class="line">#         aacio &lt;= aacio::newaccount            {&quot;creator&quot;:&quot;aacio&quot;,&quot;name&quot;:&quot;exchange&quot;,&quot;owner&quot;:{&quot;threshold&quot;:1,&quot;keys&quot;:[{&quot;key&quot;:&quot;AAC7ijWCBmoXBi3CgtK7DJxe...</div><div class="line"></div><div class="line">$ claac set contract exchange build/contracts/exchange -p exchange</div><div class="line">Reading WAST...</div><div class="line">Assembling WASM...</div><div class="line">Publishing contract...</div><div class="line">executed transaction: 5a63b4de8a1da415590778f163c5ed26dc164c960185b20fd834c297cf7fa8f4  35172 bytes  10000 cycles</div><div class="line">#         aacio &lt;= aacio::setcode               {&quot;account&quot;:&quot;exchange&quot;,&quot;vmtype&quot;:0,&quot;vmversion&quot;:0,&quot;code&quot;:&quot;0061736d0100000001f0023460067f7e7f7f7f7f00600...</div><div class="line">#         aacio &lt;= aacio::setabi                {&quot;account&quot;:&quot;exchange&quot;,&quot;abi&quot;:{&quot;types&quot;:[{&quot;new_type_name&quot;:&quot;account_name&quot;,&quot;type&quot;:&quot;name&quot;}],&quot;structs&quot;:[{&quot;n...</div></div><!-- fragment --> </div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
